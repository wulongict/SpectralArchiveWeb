<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <style>
    #networksvg {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .links line {
      /*stroke: #999;*/
      /*stroke-opacity: 0.6;*/
    }

    .nodes circle {
      stroke: #fff;
      cursor: pointer;
      /*stroke-width: 1.5px;*/
    }

    .contextmenu {
      position: absolute;
      padding: 0px;
      background: #fff;
      color: #555;
      border: 1px solid #C6C6C6;
    }

    .contextmenu a {
      display: block;
      color: #555;
      padding: 2px;
      cursor: default;
    }

    .contextmenu a:hover {
      color: #fff;
      background: #3879D9;
    }

    .tooltip-inner {
      max-width: 100% !important;
      /* text-align: left !important; */
    }

    #denovoplot {
      width: 100%;
      overflow: auto;
      border: 1px solid lightgrey;
    }

    #nodestable tbody tr td:first-child {
      cursor: pointer;
    }

    h1 {
      font-size: 1.5rem; 
      font-family: Harding,Palatino,serif;
    }

    h2 {
      font-size: 1.5rem; 
      font-family: Harding,Palatino,serif;
    }

    p {
      font-size: 1.25rem; 
      font-family: Harding,Palatino,serif;
      line-height: 2em;
    }

    /* figcaption {
      color:blue;
      font-size: 16px;
    } */

    /* figure {
  border: 1px #cccccc solid;
  padding: 4px;
  margin: auto;
} */

figcaption {
  background-color: white;
  color: green;
  font-size: 16px;
  /* font-style: italic; */
  padding: 2px;
  /* text-align: center; */
}

    /* h1 {color:red;}
    p {color:blue;} */

  </style>
  <!-- Required meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
    integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous" />
  <link href="/lorikeet/css/my.css" rel="stylesheet" type="text/css">
  <!-- <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script> -->
  <!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script data-require="snap.svg@*" data-semver="0.3.0" src="//cdn.jsdelivr.net/snap.svg/0.3.0/snap.svg-min.js">
  </script>
  <!-- add our script for bootstrap -->
  <!-- We are happy now -->
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> -->
  <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
    </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
    integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous">
    </script>
  <!-- this is the code for Data Table, responsive: -->
  <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>

  <script src="../shared_functions.js"></script>
  <script src="../run.js"></script>
  <script src="../chromatogram.js"></script>
  <!-- those are for lorikeet -->
  <!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> -->
  <!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.4/jquery-ui.min.js" ></script> -->
  <script type="text/javascript" src="/lorikeet/js/jquery.flot.js"></script>
  <script type="text/javascript" src="/lorikeet/js/jquery.flot.selection.js"></script>
  <script type="text/javascript" src="/lorikeet/js/specview.js"></script>
  <script type="text/javascript" src="/lorikeet/js/peptide.js"></script>
  <script type="text/javascript" src="/lorikeet/js/aminoacid.js"></script>
  <script type="text/javascript" src="/lorikeet/js/ion.js"></script>
  <script type="text/javascript" src="/lorikeet/js/internal.js"></script>
  <link rel="stylesheet" type="text/css" href="/lorikeet/css/lorikeet.css" />
  <title>Spectroscape Documentation</title>

</head>

<body>


  <div class="container-fluid" id="archive_navigation_bar"></div>

<div class="container-fluid col-11  " class="mx-auto">
    <article>
        <h1>Spectroscape User Manual with GIFs</h1>
        <!-- <section>
          <h3>Introduction</h3>
           <p class="text-justify">Traditional search uses user defined parameters, such as precursor/fragment mass tolerance window, sequence/spectral database, user-specified post-translational modifications (PTMs), to specify searching space. This results in inferior peptide spectrum matches (PSMs) when the correct peptide candiates is out of the search space. Here, we present spectral archive search as an alternative to make it possible for searching against the most complete spectral space. Using advanced indxing techniques and efficient data compressing step, we can build a real-time spectral archive tool without any parameters. The idea behind this archive search tool is simple: for each spectral, if it is reproducible, it must have a close spectral neighbor, given that we have collect a large number of spectra (annotated by others).  </p>
          <p class="text-justify">This new apporach enables one to detect recurring analytes, with the potential to detect PTMs based on the mass difference of the matched spectral pairs. It can also shed light to the so called "dark matter" as more and more data added to the spectral archive. The spectral archive approach can be built and updated incrementally in linear time. It provides an easy way for introspection on previously released data sets and correct the historical errors. It is a powerful tool to mining into historical data to support new hypothesis. After converted into our .mz format, the local mass spectral file can be searched directly against the spectral archive. </p>

        </section> -->


        <section>

          <h2>Search query</h2>
          <p class="text-justify">Each MS2 spectrum in the archive is designated with an identifier (id). The identifier ranges from 0 to size of the archive (exclusive). The following example shows how to search an query spectra from NIST library. The query id is <a href="http://omics.ust.hk:8709/id/25757878">25757878</a>. </p>
          <figure class="figure">
            <img src="/images/library-bridge.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption >Fig.1 - library entry as a bridge of two clusters.</figcaption>
          </figure>

          <h2>Tooltip on node and edges, PSM visualization and search new query</h2>
          <p class="text-justify">Mouse over any node or edge to show the tooltip information. Single click on any node to show the PSM on the right side using Lorikeet. Double click on any node to start a new search using that node as query spectrum.</p> 
          
          <figure class="figure">
            <img src="/images/tooltip-node-edge-click.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption>Fig.2 - Tooltip on node and edges. Single click to show the PSM. Double click to start a new search.</figcaption>
          </figure>

          <h2>Tuning parameters of graph</h2>
          <p class="text-justify">Change the strength of repulsive force between nodes and the attractive force (gravity) to the center. Also adapt the width of edges. </p>

          <figure class="figure">
            <img src="/images/tuning-parameters-of-graph.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption >Fig.3 - Tuning the parameters of the graph, repusive and attractive force, and edge width.</figcaption>
          </figure>

          <h2>Investigate unidentified PSM corresponding to semitryptic peptide</h2>
          <p class="text-justify"> The following examples shows how to find the correct solution of an unidentified peptide. The query id is <a href="http://omics.ust.hk:8709/id/18497303">18497303 </a>. In this case, the query node is in black color which means it is not identified. However, there are many neighbors in red are identified as DDPLTNLNTAFDVAEK, and the highlighted edge suggests that the delta mass is 230Da, which equals to mass of "DD". So we can guess if we remove the DD from "DDPLTNLNTAFDVAEK", the remaining part "PLTNLNTAFDVAEK" will match to the query node. In the PSM viewer, we edit the peptide and click update button, and see it is a very good PSM. The user can send a message to the server to report this error. </p>
          <figure class="figure">
            <img src="/images/semi-tryptic-case-study.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption >Fig.4 - Investigate into the unidentified PSM using the information of its neighbors. The highlighted edges shows the mass difference of 230 Da equals to the mass of "DD". And we find the red nodes are all matched with a peptide that starts with "DD". What if we remove the DD and use the remaining part to match with the query spectrum? Yes, it turns out that the correct anwser is "PLTNLNTAFDVAEK".</figcaption>
          </figure>

          <h2>Investigate into mixture spectra of two similar peptides</h2>
          <p class="text-justify"> The following example shows two similar peptides co-fragmented into one MS2 spectrum.  The query id is <a href="http://omics.ust.hk:8709/id/18793053">18793053 </a>. In this case, the neighbors of the query node form one tightly connected cluster. All of them are identified, but as two different peptides, ADIDVSGPK and ADVDISGPK. Thse two peptides share many fragment ions. From the back-to-back PSM plot implemented in Spectroscape interface, one can clearly see the query spectra contains peaks of both peptides.  </p>
            
            <p>There are four different mode when it comes to the back-to-back plot: query, neighbor, separate and mixture. In the first three mode, the back-to-back plot shows two spectra, the top spectrum is the one user selected by single clicking on the neighbouring node, and the bottom one is the query spectrum. The query method will annotate the two spectrum with the peptide of query node. The neighbor method will annotate the two spectrum with the peptide of the user selected spectra. The separate method will annotate the two spectra with their own peptide. The last method, the mixture annotation will show top and bottom with the same query spectrum, but annotated with query peptide (bottom) and peptide of user selected node (top).  </p>
          <figure class="figure">
            <img src="/images/mixture-spectra-case-study.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption >Fig.5 - Investigate into a mixture spectra. The cluster returned by Spectroscape contains two different peptides. According to the analysis with back-to-back PSM plot, we can tell the query node is a mixture of peptide ADIDVSGPK and ADVDISGPK . </figcaption>
          </figure>

          <h2>Search a peak list out of archive</h2>
          <p class="text-justify"> It is possible to search a peak list out of the archive, the only information we need is a peak list. The peak list should contain multiple rows, each row is a pair of values, mz and intensity. Here is an example peak list. </p>
          
          <p>
120.058 48</br>
156.100 35</br>
175.113 39</br>
201.114 50</br>
207.095 36</br>
214.054 38</br>
229.099 43</br>
258.122 32</br>
298.131 31</br>
303.105 30</br>
312.169 25</br>
333.135 23</br>
362.188 46</br>
379.156 26</br>
425.238 21</br>
433.234 45</br>
438.178 22</br>
441.169 28</br>
466.163 29</br>
496.284 27</br>
566.293 18</br>
583.322 47</br>
596.292 42</br>
682.383 41</br>
759.350 37</br>
765.423 16</br>
783.429 49</br>
873.396 33</br>
893.477 19</br>
894.453 34</br>
911.482 44</br>
974.441 24</br>
1044.450 17</br>
1058.549 20</br>
1061.479 40</br>
1145.586 15</br>

          </p>
          <p class="text-justify"> This Peak list above actually is the query spectrum <a href="http://omics.ust.hk:8709/id/21958751">21958751</a>. Now we can open the Spectroscape web interface, choose to search a peak list, then we can paste the peaks above to the text box and click button "search peak list". It's done. The web interface will show the network between the query spectra and its neighbors. Note that this spectrum is out of the archive, therefore its query id become "-1". 
          </p>
          <figure class="figure">
            <img src="/images/search-a-peak-list.gif" class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure.">
            <figcaption >Fig.6 - Search a peak list. It turns out that this is a mixture spectrum. It is actually from the archive, where the query id is <a href="http://omics.ust.hk:8709/id/21958751">21958751</a>. </figcaption>
          </figure>

        </section>
      </article>

</div>
<div class="container-fluid" style="visibility: hidden">
    <div class="page-header" color="blue">
      <h1>Spectral Cluster Viewer</h1>
      <p>
        This is a spectral archive built from 7,849,350 MS2 spectra (updated
        on August 14, 2018). No spectra is filtered out from this process.
      </p>
    </div>
  </div>

<script>
    $(document).ready(add_navigation_bar_doc_page);
</script>

</body>

</html>