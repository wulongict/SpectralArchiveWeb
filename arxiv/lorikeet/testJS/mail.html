<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <style>
        .links line {
            /*stroke: #999;*/
            /*stroke-opacity: 0.6;*/
        }

        .nodes circle {
            stroke: #fff;
            /*stroke-width: 1.5px;*/
        }

        .tooltip-inner {
            max-width: 100% !important;
            /* text-align: left !important; */
        }
    </style>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
          integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous" />

<!--    TEST-->
    <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.11.0.css">
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="../js/aminoacid.js"></script>
    <script src="../js/ion.js"></script>
    <script src="../js/peptide.js"></script>
    <script src="../js/internal.js"></script>
    <script src="http://code.jquery.com/qunit/qunit-1.11.0.js"></script>
    <script src="testmyJs.js"></script>

<!--    TEST END-->


    <!-- <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script> -->
    <!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script data-require="snap.svg@*" data-semver="0.3.0" src="//cdn.jsdelivr.net/snap.svg/0.3.0/snap.svg-min.js">
    </script>
    <!-- add our script for bootstrap -->
    <!-- We are happy now -->
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> -->
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
            integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
            integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous">
    </script>
    <!-- this is the code for Data Table, responsive: -->
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>

    <script src="../shared_functions.js"></script>
    <script src="../run.js"></script>
    <!-- those are for lorikeet -->
    <!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> -->
    <!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.4/jquery-ui.min.js" ></script> -->
    <script type="text/javascript" src="../js/jquery.flot.js"></script>
    <script type="text/javascript" src="../js/jquery.flot.selection.js"></script>
    <script type="text/javascript" src="../js/specview.js"></script>
    <script type="text/javascript" src="../js/peptide.js"></script>
    <script type="text/javascript" src="../js/aminoacid.js"></script>
    <script type="text/javascript" src="../js/ion.js"></script>
    <script type="text/javascript" src="../js/internal.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/lorikeet.css" />
    <title>Spectral Cluster Viewer</title>
</head>

<body>
<div id="qunit"></div>
<div id="qunit-fixture"></div>

<div class="container-fluid" id="archive_navigation_bar"></div>
<div class="container-fluid" id="archive_navigation_bar2"></div>

<div class="container-fluid">
    <div class="row   bg-light ">

        <div class="form-row col-xd-12 col-sm-12 col-md-12  col-lg-11">



            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="port">
                    <a href="#" data-toggle="tooltip"
                       title="the port for searching service. Default: 8700; Valid range  8700~8710">
                        Port
                    </a>
                </label>
                <select class="form-control " id="port">
                    <option value="8708">8708</option>
                    <option value="8709" selected>8709</option>
                </select>
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="peptidecolor">
                    <a href="#" data-toggle="tooltip"
                       title="The methods for coloring peptides: use sequence determined color, or use group based color.">
                        Color
                    </a>
                </label>
                <select class="form-control " id="peptidecolor" onchange="peptidecolorchanged()">
                    <option value="group">group</option>
                    <option value="sequence" selected>sequence</option>
                </select>
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="svggravitystrength">
                    <a href="#" data-toggle="tooltip"
                       title="the strength of gravity to the center of the svg figure for spectral network visualization. Valid range: 0.01 ~ 100">
                        Gravity
                    </a>
                </label>

                <select class="form-control" id="svggravitystrength" name="svggravitystrength" onchange="update_with_max_dist()">
                    <option value="0.1">0.1</option>
                    <option value="0.5" selected>0.5</option>
                    <option value="1">1</option>
                    <option value="5">5</option>

                </select>
                <!-- <input
                    type="text"
                    class="form-control"
                    id="svggravitystrength"
                    name="svggravitystrength"
                    value="0.5"
                  /> -->
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="topn">
                    <a href="#" data-toggle="tooltip" title="Number of items returned in each round. Valid range: 1 ~ 80">
                        #Neighbors
                    </a>
                </label>
                <select class="form-control" id="topn" name="topn">
                    <option value="10">10</option>
                    <option value="20" selected>20</option>
                    <option value="30">30</option>
                    <option value="40">40</option>
                    <option value="50">50</option>
                    <option value="60">60</option>
                    <option value="70">70</option>
                    <option value="80">80</option>
                    <option value="90">90</option>
                    <option value="100">100</option>

                </select>

                <!-- <input
                    type="text"
                    class="form-control"
                    id="topn"
                    name="topn"
                    value="20"
                  /> -->
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="nodesize">
                    <a href="#" data-toggle="tooltip" title="Size of the node in network plot. Valid range: 1 ~ 12">
                        Node Size
                    </a>
                </label>
                <select class="form-control" id="nodesize" name="nodesize" onchange="onNodeSizeChange()">
                    <option value="3">3</option>
                    <option value="6" selected>6</option>
                    <option value="9">9</option>
                    <option value="12">12</option>
                    <option value="15">15</option>
                    <option value="18">18</option>




                </select>

                <!-- <input
                    type="text"
                    class="form-control"
                    id="nodesize"
                    name="nodesize"
                    value="6"
                  /> -->
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="MAXDist">
                    <a href="#" data-toggle="tooltip"
                       title="Maximal Euclidian distance allowed to draw a edge. Valid range: 0.01 to 1.414. L2[x,y]=sqrt(2-2*cos[x,y]); L2<0.8 ~ Cos>0.68">
                        MaxDist
                    </a>
                </label>
                <input type="text" class="form-control" id="MAXDist" name="MAXDist" value="0.8" onchange="update_with_max_dist()"/>
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="ProbType">
                    <a href="#" data-toggle="tooltip"
                       title="The type of probability score to be used to filter PSMs. PeptideProphet and iProphet probability score are supported. We also support to show 'significant' identification. Significance 0 denotes FDR>1%, 1 denotes FDR<1%">
                        Score
                    </a>
                </label>
                <select class="form-control" id="ProbType" onchange="peptidecolorchanged()">
                    <option value="Significance" selected>Significance</option>
                    <option value="PeptideProphet">PeptideProphet</option>
                    <option value="iProphet">iProphet</option>
                </select>
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="MinProb">
                    <a href="#" data-toggle="tooltip"
                       title="Minimal peptideProphet or iProphet probability reqiured to show a node as identified by a peptide. Significance 0 denotes PSM with FDR<1%, 1 denotes PSM with FDR>1%">
                        Cutoff
                    </a>
                </label>
                <input type="text" class="form-control" id="MinProb" name="MinProb" value="0.8" onchange="peptidecolorchanged()"/>
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="QUERYID">
                    <a href="#" data-toggle="tooltip" title="The archive unique id for query. Valid range: 1 ~ 2,000,000">
                        Query ID
                    </a>
                </label>
                <input type="text" class="form-control" id="QUERYID" name="QUERYID" value="16189" />
            </div>
            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="NPROBE">
                    <a href="#" data-toggle="tooltip" title="The number of buckets to use. Valid range: 1 ~ 256">
                        #Buckets
                    </a>
                </label>
                <select class="form-control" id="NPROBE" name="NPROBE" onchange="StoreNPROBE()">
                    <option value="2">2</option>
                    <option value="4">4</option>
                    <option value="8" >8</option>
                    <option value="16" selected>16</option>
                    <option value="32">32</option>
                    <option value="64">64</option>
                    <!-- <option value="128">128</option> -->


                </select>

                <!-- <input
                    type="text"
                    class="form-control"
                    id="NPROBE"
                    name="NPROBE"
                    value="256"
                    onchange="StoreValues()"
                  /> -->
            </div>

            <div class="form-group col-md-2 col-lg-1  col-sm-3 col-xd-3">
                <label for="NeighborDistance">
                    <a href="#" data-toggle="tooltip"
                       title="Calculate distance between candidates/neighbors (YES) or not (NO).">
                        Network
                    </a>
                </label>
                <select class="form-control" id="NeighborDistance" onchange="StoreValues()">
                    <option value="1" selected>YES</option>
                    <option value="0">NO</option>
                </select>
            </div>

            <div class="form-group  col-md-2 col-lg-1  col-sm-3 col-xd-3  align-self-end ">
                <button id="searchbtn" type="button" class="btn btn-primary form-control  ">
                    Search
                </button>
            </div>

        </div>


        <div class=" form-row col-lg-1  align-self-end align-bottom">

            <!-- <div class="form-group  col-lg-6 ">
              <button id="saveSVGimg" type="button" class=" btn form-control btn-primary  "
                onclick="saveSVG()">
                Save SVG
              </button>
            </div> -->

            <div class="form-group col-lg-12  ">
                <button id="peptidelabelbtn" type="button" class=" btn btn-primary form-control ">
                    Label
                </button>
            </div>
            <!-- </div> -->
        </div>


    </div>

    <div class="container-fluid row justify-content-left ">
        <div class="container-fluid row bg-light col-12">
            <div id="nodeinfo2" class=" form-group bg-light">
                <p class="text-primary ">
                    User Manual: mouse over one of the node on left side. Press 's'
                    (lower case) on keyboard to show the PSM with
                    <a href="https://github.com/jmchilton/lorikeet" target="_blank">Lorikeet viewer</a>
                    on right side.
                </p>
            </div>
        </div>
        <div class="col-md-12 col-lg-5 col-sm-12 " id="networksvg">
            <svg id="spectralnetwork" class="spectralnetwork" xmlns="http://www.w3.org/2000/svg"></svg>
        </div>
        <div class="col-md-12 col-lg-7 col-sm-12 container">
            <div id="lorikeet2" width="100%">
                <p class="text-primary ">
                    User Manual: mouse over one of the node on left side. Press 's' on
                    keyboard to show the PSM with
                    <a href="https://github.com/jmchilton/lorikeet" target="_blank">Lorikeet viewer</a>
                    on right side.
                </p>
            </div>
        </div>
    </div>
</div>

<!---------------------------- The PSM Viewer part ---------------------->
<!-- todo list: support the PTM sequence. remove the svg width and height constrain; -->
<div class="container-fluid ">
    <h2>PSM Viewer</h2>
    <div class="row justify-content-left">
        <div class="col-sm-3 col-lg-2 col-md-2">
            <form class="form-horizotal" onsubmit="return false;">
                <div class="form-group">
                    <label for="peptideptm">
                        <a href="#" data-toggle="tooltip"
                           title="Peptide (with PTM in bracket, e.g. M[147], C[160]) for query node">
                            Peptide[PTM]
                        </a>
                    </label>
                    <input type="text" class="form-control" id="peptideptm" name="peptideptm" value="AAACCCK" />
                </div>
                <!-- <div class="form-group">
                  <label for="peptide">
                    <a href="#" data-toggle="tooltip" title="Peptide Sequence for Selected node">
                      Peptide
                    </a>
                  </label>
                  <input type="text" class="form-control" id="peptide" name="peptide" value="AAACCCK">
                </div> -->
                <!--
                <div class="form-group">
                  <label for="precursor">
                    <a href="#" data-toggle="tooltip" title="precursor neutral mass">
                      Precursor Mass
                    </a>
                  </label>
                  <input type="text" class="form-control" id="precursor" name="precursor" value="1000">
                </div> -->

                <div class="form-group">
                    <label for="charge">
                        <a href="#" data-toggle="tooltip" title="precursor charge state; valid range 1 to 6">
                            Charge
                        </a>
                    </label>
                    <input type="text" class="form-control" id="charge" name="charge" value="2" />
                </div>

                <div class="form-group">
                    <label for="peaks">
                        <a href="#" data-toggle="tooltip" title="The peaks of tandem mass spectra; m/z intensity pairs;">
                            Peak List
                        </a>
                    </label>
                    <textarea id="peaks" class="form-control" rows="5"></textarea>
                </div>

                <div class="form-group">
                    <button id="showspecview" type="button" class="btn btn-primary form-control" onclick="get_spectra_byid()">
                        Update PSM
                    </button>
                </div>
                <div class="form-group">
                    <label for="remarks">
                        <a href="#" data-toggle="tooltip" title="Show the annotation of a spectra, and submit it to server">
                            Remarks
                        </a>
                    </label>
                    <div id="remark_options" >

                    </div>




                    <textarea id="specremarks" class="form-control" rows="5" placeholder="Users could write down (anonymous) comment for this cluster and this query spectrum, and submit to our server, which can be retrieved later."></textarea>
                </div>

                <div class="form-group">
                    <button id="submit_remarks" type="button" class="btn btn-primary form-control"
                            onclick="submit_remarks_for_id()">
                        Submit Remarks
                    </button>
                </div>
            </form>
        </div>
        <div class="col-sm-9 col-md-10 col-lg-10 bg-light justify-content-center">
            <div id="lorikeet"></div>
        </div>
    </div>
</div>

<!-- ------------------------------The De novo visualization part ------------- -->
<div class="container-fluid" id="denovodiv">

</div>

<!-- -----------------------------------The node and link table --------------------------  -->
<div id="nodesdiv" class="table-responsive container-fluid">
    <h2>Table of nodes</h2>
    <table id="nodestable" class="table  table-bordered">
        <thead>
        <tr>
            <th>ID</th>
            <th>Peptide Sequence</th>
            <th>Expect score</th>
            <th>PeptideProphet probability</th>
            <th>iProphet Probability</th>
            <th>Precursor Mass (m/z)</th>
            <th>Charge</th>
            <th>C terminus Modification</th>
            <th>N terminus Modification</th>
            <th>Other modifications</th>
            <th>Data File Name</th>
            <th>Scan</th>
            <th>Retention Time</th>
            <th>Group</th>
            <!-- 'id', 'peptide', 'score', 'group','precursor','charge','cterm','nterm','othermod' -->
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
<div id="linksdiv" class="table-responsive container-fluid">
    <h2>Table of links/edges</h2>
    <table id="linkstable" class="table  table-bordered">
        <thead>
        <tr>
            <th>source id</th>
            <th>source peptide</th>
            <th>source score</th>
            <th>source group</th>
            <th>target id</th>
            <th>target peptide</th>
            <th>target score</th>
            <th>target group</th>
            <th>delta mass</th>
            <th>distance</th>
            <th>real L2 distance</th>
            <th>cosine</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
<div class="alert alert-info container" role="alert">
    <p id="errorinfo"></p>
</div>

<div class="container-fluid" style="visibility: hidden">
    <div class="page-header" color="blue">
        <h1>Spectral Cluster Viewer</h1>
        <p>
            This is a spectral archive built from 7,849,350 MS2 spectra (updated
            on August 14, 2018). No spectra is filtered out from this process.
        </p>
    </div>
</div>
<script>

    $(document).ready(function () {
        var tmpgraph = JSON.parse(g_jsonstring);
        $('[data-toggle="tooltip"]').tooltip();
        try {

            $("#nodestable").DataTable({
                responsive: true,
                data: tmpgraph.nodes,
                rowCallback: function (row, data) {
                    var minprob = parseFloat($("#MinProb").val());
                    var ProbType = $("#ProbType").val();
                    var the_prob = 0;
                    if (ProbType == "PeptideProphet") {
                        the_prob = data.pProb;
                    } else if (ProbType == "iProphet") {
                        the_prob = data.iProb;
                    } else if (ProbType === "Significance") {
                        // console.log("data in the row: ",data);
                        the_prob = data.significance;
                    }
                    if ($("#peptidecolor").val() == "group") {
                        $("td:eq(13)", row).css("background-color", function () {
                            if (the_prob >= minprob || data.filename.includes(".sptxt")) {
                                return color(data.group);
                                $("td:eq(13)", row).css(
                                    "background-color",
                                    color(data.group)
                                );
                            } else {
                                // return color(1); // treat as group unknown
                                $("td:eq(13)", row).css("background-color", color(1));
                            }
                        }); // to be fixed
                    } else if ($("#peptidecolor").val() == "sequence") {
                        $("td:eq(13)", row).css("background-color", function () {
                            if (the_prob >= minprob || data.filename.includes(".sptxt")) {
                                $("td:eq(13)", row).css(
                                    "background-color",
                                    color_of_string(data["peptide"])
                                );
                                // return color_of_string(data.peptide);
                                // return color(data.group);
                            } else {
                                $("td:eq(13)", row).css(
                                    "background-color",
                                    color_of_string("UNKNOWN")
                                );
                                // return color_of_string("UNKNOWN"); // treat as group unknown
                            }
                            // to be fixed
                        });
                    }
                },
                columns: [{
                    data: "id"
                },
                    {
                        data: "peptide"
                    },
                    {
                        data: "score"
                    },
                    {
                        data: "pProb",
                        render: function (data, type, row) {
                            return data.toFixed(4);
                        }
                    },
                    {
                        data: "iProb",
                        render: function (data, type, row) {
                            return data.toFixed(4);
                        }
                    },
                    {
                        data: "precursor"
                    },
                    {
                        data: "charge"
                    },
                    {
                        data: "cterm"
                    },
                    {
                        data: "nterm"
                    },
                    {
                        data: "othermod"
                    },
                    {
                        data: "filename"
                    },
                    {
                        data: "scan"
                    },
                    {
                        data: "rt"
                    },
                    {
                        data: "group"
                    }
                ]
            });
            // $('#linkstable').DataTable();
        } catch (err) {
            document.getElementById("errorinfo").innerHTML +=
                gettimestr() +
                " <strong>Warning: </strong> " +
                err.message +
                "<br/>";
            console.log("error message:", err.message);
        }
        var table = $("#nodestable").DataTable();
        $("#nodestable tbody").on("click", "td", function () {
            var thedata = table.cell(this).data();
            console.log("cell data", thedata);
            // alert('You clicked on ' + thedata["id"] + '\'s row');
            if (table.cell(this).index().column == 0) {
                search_with_queryid(thedata);
            }
            // openInNewTab("http://spec.ust.hk:8709/id/"+thedata["id"])
        });
        try {
            // $("#nodestable").DataTable();
            $("#linkstable").DataTable({
                responsive: true,
                data: tmpgraph.links,
                rowCallback: function (row, data) {
                    if ($("#peptidecolor").val() == "group") {
                        $("td:eq(3)", row).css(
                            "background-color",
                            color(data["source group"])
                        );
                        $("td:eq(7)", row).css(
                            "background-color",
                            color(data["target group"])
                        );
                    } else if ($("#peptidecolor").val() == "sequence") {
                        $("td:eq(3)", row).css(
                            "background-color",
                            color_of_string(data["source peptide"])
                        );
                        $("td:eq(7)", row).css(
                            "background-color",
                            color_of_string(data["target peptide"])
                        );
                    }
                },
                columns: [{
                    data: "source id"
                },
                    {
                        data: "source peptide"
                    },
                    {
                        data: "source score"
                    },
                    {
                        data: "source group"
                    },
                    {
                        data: "target id"
                    },
                    {
                        data: "target peptide"
                    },
                    {
                        data: "target score"
                    },
                    {
                        data: "target group"
                    },
                    {
                        data: "deltamass"
                    },
                    {
                        data: "distance"
                    },
                    {
                        data: "real L2 distance"
                    },
                    {
                        data: "cosine"
                    }
                ]
            });
        } catch (err) {
            document.getElementById("errorinfo").innerHTML +=
                gettimestr() +
                " <strong>Warning: </strong> " +
                err.message +
                "<br/>";
            console.log("error message:", err.message);
        }

        console.log("Table converted to DataTable now Call ready now: ctrl+F5");
        clicksearchbtn();
    });
    d3.select("#peptidelabelbtn")
        .on("click", function () {
            if (
                d3
                    .select(".spectralnetwork")
                    .selectAll("text")
                    .attr("visibility") == "visiable"
            ) {
                d3.select(".spectralnetwork")
                    .selectAll("text")
                    .attr("visibility", "hidden");
            } else {
                d3.select(".spectralnetwork")
                    .selectAll("text")
                    .attr("visibility", "visiable");
            }
        });
    add_naviation_bar_cluster_page();
    add_remark_options();
    add_denovo_section_to_page()
    g_jsonstring = '{"nodes":[],"links":[]}';
    d3.select("#searchbtn").on("click", clicksearchbtn);
    add_Enter_to_trigger_click("topn", "searchbtn");
    add_Enter_to_trigger_click("QUERYID", "searchbtn");


    var getLocation = function (href) {
        var l = document.createElement("a");
        l.href = href;
        return l;
    };
    var thePath = getLocation(document.URL);
    color = generate_color();
    var portval = document.URL.split(":")[2].split("/")[0];
    console.log("port: ", portval);
    $("#port").val(portval);
    console.log(
        "This is how I parse the param: ",
        document.URL,
        location.TOPN
    );
    var param_in_url = document.URL.split("?")[1];
    var multipleparam = param_in_url.split("&");
    var newtopN = "20";
    for (var i = 0; i < multipleparam.length; i++) {
        var currentparam = multipleparam[i].split("=");
        if (currentparam[0] == "TOPN") {
            newtopN = currentparam[1];
            $("#topn").val(newtopN);
        }
    }

    var tolerrorinput = document.getElementById("tolerance");
    tolerrorinput.addEventListener("keyup", function (event) {
        event.preventDefault();
        if (event.keyCode == 13 && event.which) {
            console.log("haha");
            do_denovo_sequencing();
        }
    });
</script>
</body>

</html>